## Java 10 新特性

### 局部变量类型推断

引入了var关键字，允许开发者在声明局部变量时不必显式声明变量的类型，编译器会自动根据变量的初始值推断变量的类型。这使得代码更加简洁，尤其是在处理泛型时。

~~~
var list = new ArrayList<String>();  // 编译器推断 list 是 ArrayList<String> 类型
var stream = list.stream();          // 编译器推断 stream 是 Stream<String> 类型
~~~

需要注意的是，var只能用在局部变量上，不能用于类的成员变量、方法参数或返回类型。

### 统一的垃圾回收接口

hotspot/gc代码实现方面，引入一个干净的GC接口，改进不同GC源代码的隔离性，多个GC
之间共享的实现细节代码应该存在于辅助类中。这种方式提供了足够的灵活性来实现全新GC
接口，同时允许以混合搭配方式重复使用现有代码，并且能够保持代码更加干净、整洁，便于排查收集器问题。

### 并行全垃圾回收器G1

为了最大限度地减少FullGC造成的应用停顿的影响，Java 10为G1引入多线程并行GC，同时会使用与年轻代回收和混合回收相同的并行工作线程数量，从而减少了
FullGC的发生，以带来更好的性能提升、更大的吞吐量。
为了利用并行FullGC，通常不需要特别的配置，因为G1在Java 10及以上版本默认就是并行执行Full GC的。但是，可以通过JVM
参数来调整并行线程的数量，-XX:ParallelGCThreads=\<N>参数，其中\<N>是希望使用的线程数。

### 应用程序类数据共享

AppCDS允许开发者将应用程序自己的类包含进共享归档中，从而提升了启动性能和减少了资源占用。

### 线程-局部变量管控

这是在JVM内部相当低级别的更改，现在将允许在不运行全局虚拟机安全点的情况下实现线程回调。这将使得停止单个线程变得可能和便宜，而不是只能启用或停止所有线程。

### 移除Native-Header自动生成工具

在Java 9之前，javah是一个用来生成C头文件（即.h文件）的工具，这些头文件是从Java代码中定义的native方法所必需的，通常用于
Java与本地代码（如C或C++代码）之间的互操作。但是它在Java 9被废弃，并在Java 10中被移除，原因是javac编译器已经提供了相同的功能。

### 额外的Unicode语言标签扩展

| 编码 |   注释   |
|:--:|:------:|
| cu |  货币类型  |
| fw | 一周的第一天 |
| rg |  区域覆盖  |
| tz |   时区   |

Java 10提升了对这些Unicode扩展的支持，特别是与区域设置相关的功能。这项增强允许开发者在Java应用程序中指定更详细的语言和区域设置偏好。

### 备用存储装置上的堆分配

Java 10新特性（备用存储装置上的堆分配）允许JVM能够使用适用于不同类型的存储机制的堆，在可选内存设备上进行堆内存分配。这么做的目的是为了允许使用那些具有不同性能特征存储设备的系统上的
JVM更好地管理其内存。
使用参数-XX:+UseNVDIMM来开启。

### 基于Java的实验性JIT编译器

Java 10引入了一项名为"基于Java的实验性JIT编译器"的新特性，该编译器是基于Graal开源项目，用Java编写的。Java
10将其用作Linux/x64平台上的实验性JIT编译器开始进行测试和调试工作，以作为Java HotSpot VM的一个实验性替代品。开启方式如下：  
-XX:+ UnlockExperimentalVMOptions -XX:+ UseJVMCICompiler

### 根证书认证

从Java 10开始，将会在JDK中提供一套默认的CA根证书。该跟证书是OpenJDK提供的一组开源的CA根证书，这样就不再需要手动配置CA根证书，因为它们已经包含在JDK中了。

### 基于时间的版本发布模式

引入了一种新的版本发布模式，标志着Oracle对Java发布策略的一次重大改变。这一新模式被称为基于时间的发布版本模式，这就意味着Java将会有更加频繁且可预测的版本更新。

### 新增 API

添加了73个新API，下面是一些主要的：

|                                            API                                            | 描述                                                       |
|:-----------------------------------------------------------------------------------------:|:---------------------------------------------------------|
|                            List.copyOf, Set.copyOf, Map.copyOf                            | 这些方法提供了一种创建不可修改集合的快捷方式，参数是现有的集合。                         |
| Collectors.toUnmodifiableList, Collectors.toUnmodifiableSet, Collectors.toUnmodifiableMap | 这些方法允许将Stream的元素收集到不可修改的集合中                              |
|                                  Optional.orElseThrow()                                   | Optional.get()的一个更易读的替代，它在值不存在时抛出NoSuchElementException。 |